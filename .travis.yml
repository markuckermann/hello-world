branches:
  only:
  - master
  - demo
  - /^rc-\d+\.\d+/

services:
  - docker

language: cpp
os: linux
dist: bionic

env:
  global:
    - GLOBALVAR=imaglobalvar
  matrix:
    - BUILD=1 TAG=k
    - BUILD=2 TAG=2TAG
    - BUILD=3 TAG=asdflj

before_install: 
  - echo "before install"

install: echo "No install action required"

script:
  - echo "Running build $BUILD $TAG"
  - echo $BUILD $TAG | tee > ~/$TRAVIS_BUILD_NUMBER/build_$BUILD.txt

jobs:
  include:
    - stage: test
      name: "Unit Tests"
      script: echo TEST $BUILD $TAG | tee > ~/$TRAVIS_BUILD_NUMBER/test.txt

    - stage: deploy
      env:
      install:
      before_script:
      script:
        - cat ~/$TRAVIS_BUILD_NUMBER/*
